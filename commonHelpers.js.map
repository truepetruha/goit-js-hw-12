{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst modalLightboxGallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst searchForm = document.querySelector('.js-search-form');\nconst ulEl = document.querySelector('.list-photo');\nconst btnLoadMore = document.querySelector('[data-action=\"load-more\"]');\nconst loader = document.querySelector('.loader');\nconst loaderLoadMore = document.querySelector('.loader-load-more');\n\nconst hiddenClass = 'is-hidden';\n\nlet page = 1;\n\nlet maxPage = 0;\n\nlet query = '';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst API_KEY = '41849458-2d98265cf06659a45ba73a30c';\n\nbtnLoadMore.classList.add(hiddenClass);\n\nsearchForm.addEventListener('submit', handleSearch);\n\nbtnLoadMore.addEventListener('click', handleLoadMore);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  ulEl.innerHTML = '';\n\n  loader.classList.remove(hiddenClass);\n\n  page = 1;\n\n  const form = event.currentTarget;\n  query = form.elements.query.value.trim();\n\n  if (!query) {\n    loader.classList.add(hiddenClass);\n    btnLoadMore.classList.add(hiddenClass);\n\n    iziToast.show({\n      title: 'Error',\n      titleSize: '30',\n      messageSize: '25',\n      color: 'yellow',\n      message: 'Please search for something',\n    });\n    return;\n  }\n\n  try {\n    const { hits, totalHits } = await getPhotos(query);\n\n    maxPage = Math.ceil(totalHits / 40);\n\n    markupPhoto(hits, ulEl);\n    if (hits.length > 0 && hits.length !== totalHits) {\n      btnLoadMore.classList.remove(hiddenClass);\n    } else if (!hits.length) {\n      btnLoadMore.classList.add(hiddenClass);\n\n      iziToast.error({\n        title: 'Error',\n        titleSize: '30',\n        messageSize: '25',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    } else {\n      btnLoadMore.classList.add(hiddenClass);\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      titleSize: '30',\n      messageSize: '25',\n      message: 'Sorry! Try later! Server not working',\n    });\n  } finally {\n    loader.classList.add(hiddenClass);\n\n    form.reset();\n  }\n}\n\nasync function getPhotos(value, page = 1) {\n  try {\n    const response = await axios.get(`${BASE_URL}/`, {\n      params: {\n        key: API_KEY,\n        q: value,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: 40,\n        page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      titleSize: '30',\n      messageSize: '25',\n      message: 'Sorry! Try later! Server not working',\n    });\n    console.error(error.message);\n  }\n}\n\n// ------------------------------------------------------------КНОПКА LOAD MORE-------------------------------------------------------------\n\nasync function handleLoadMore() {\n  page += 1;\n  loaderLoadMore.classList.remove(hiddenClass);\n  btnLoadMore.classList.add(hiddenClass);\n\n  const getHeightImgCard = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n\n  try {\n    const { hits } = await getPhotos(query, page);\n    markupPhoto(hits, ulEl);\n  } catch (error) {\n    console.error(error);\n  } finally {\n    window.scrollBy({\n      top: getHeightImgCard.height * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n    loaderLoadMore.classList.add(hiddenClass);\n    btnLoadMore.classList.remove(hiddenClass);\n    if (page === maxPage) {\n      btnLoadMore.classList.add(hiddenClass);\n      btnLoadMore.removeEventListener('click', handleLoadMore);\n      iziToast.show({\n        title: 'Hey',\n        titleSize: '30',\n        messageSize: '25',\n        color: 'blue',\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  }\n}\n\nbtnLoadMore.addEventListener('click', handleLoadMore);\n\n// ------------------------------------------------------------РОЗМІТКА--------------------------------------------------------------------\n\nfunction markupPhoto(hits) {\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width=\"360\"\n            />\n          </a>\n          <ul class=\"img-list\">\n  <li class=\"img-info\">\n   <p class=\"img-text\">Likes: <br><span>${likes}</span></p>\n   <p class=\"img-text\">Views: <br><span>${views}</span></p>\n   <p class=\"img-text\">Comment: <br><span>${comments}</span></p>\n   <p class=\"img-text\">Downloads: <br><span>${downloads}</span></p>\n   </li>\n   </ul>\n        </li>`\n    )\n    .join('');\n  ulEl.insertAdjacentHTML('beforeend', markup);\n  modalLightboxGallery.refresh();\n}"],"names":["modalLightboxGallery","SimpleLightbox","searchForm","ulEl","btnLoadMore","loader","loaderLoadMore","hiddenClass","page","maxPage","query","BASE_URL","API_KEY","handleSearch","handleLoadMore","event","form","iziToast","hits","totalHits","getPhotos","markupPhoto","error","value","axios","getHeightImgCard","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}